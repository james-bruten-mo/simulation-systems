
<!DOCTYPE html>


<html lang="en" data-content_root="../../" data-theme="auto">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>UM Test Release &#8212; Simulation Systems  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "auto";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "auto";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=880b0107" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Reviewers/releases/um_test_release';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Partner Testing" href="partner_testing.html" />
    <link rel="prev" title="Curating a Release" href="../curaterelease.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="auto">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/MO_SQUARE_black_mono_for_light_backg_RBG.png" class="logo__image only-light" alt=""/>
    <img src="../../_static/MO_SQUARE_for_dark_backg_RBG.png" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">Simulation Systems</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../WorkingPractices/working_practices.html">
    Working Practices
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../Development/developing_change.html">
    Developing Your Change
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Guides for Reviewers
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../FurtherDetails/index.html">
    Further Details
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/MetOffice/simulation-systems/discussions" title="GitHub Discussions" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="far fa-comments fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub Discussions</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/MetOffice/simulation-systems" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../WorkingPractices/working_practices.html">
    Working Practices
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../Development/developing_change.html">
    Developing Your Change
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Guides for Reviewers
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../FurtherDetails/index.html">
    Further Details
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/MetOffice/simulation-systems/discussions" title="GitHub Discussions" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="far fa-comments fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub Discussions</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/MetOffice/simulation-systems" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Guides for Reviewers</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../scitechreview.html">Science and Technical Review</a></li>
<li class="toctree-l1"><a class="reference internal" href="../codereview.html">Code Review</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../howtocommit.html">Merge, Test &amp; Commit</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../committinglinkedtickets.html">Committing Linked Pull Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nightlytesting.html">Nightly Testing</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../curaterelease.html">Curating a Release</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">UM Test Release</a></li>
<li class="toctree-l2"><a class="reference internal" href="partner_testing.html">Partner Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="software_stack.html">Scientific Software Stack Update</a></li>
<li class="toctree-l2"><a class="reference internal" href="jules_release.html">Jules Release</a></li>
<li class="toctree-l2"><a class="reference internal" href="shumlib_release.html">Shumlib Release</a></li>
<li class="toctree-l2"><a class="reference internal" href="mule_release.html">Mule Release</a></li>
<li class="toctree-l2"><a class="reference internal" href="um_main_release.html">UM Main Release</a></li>
<li class="toctree-l2"><a class="reference internal" href="lfric_apps_release.html">LFRic Apps Release</a></li>
<li class="toctree-l2"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="standard_suites.html">Standard Suites</a></li>
<li class="toctree-l2"><a class="reference internal" href="stash_browser.html">Stash Browser</a></li>
<li class="toctree-l2"><a class="reference internal" href="umdp_release.html">UMDP Release</a></li>
<li class="toctree-l2"><a class="reference internal" href="wiki_pages.html">Standard Jobs and Wiki Pages</a></li>
<li class="toctree-l2"><a class="reference internal" href="shared_accounts.html">Repo and Shared Accounts Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="updating_prebuilds.html">Mid-Release Prebuilds</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Guides for Reviewers</a></li>
    
    
    <li class="breadcrumb-item"><a href="../curaterelease.html" class="nav-link">Curating a Release</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">UM Test Release</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="um-test-release">
<span id="id1"></span><h1>UM Test Release<a class="headerlink" href="#um-test-release" title="Link to this heading">#</a></h1>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>When referring to <strong>all</strong> platforms below, this means Azure Spice, EXAB,
EXCD, EXZ</p>
<p>Some of the test release only needs to be run on 1 HPC Host Zone - the
instructions for this assume EXAB, but EXCD can be used instead. Other
parts of the test release set up files for the main release - this needs
to be done on both EXAB EXCD and EXZ.</p>
</div>
<section id="preparing-test-release-branches-and-keyword-files">
<h2>Preparing Test Release Branches and Keyword Files<a class="headerlink" href="#preparing-test-release-branches-and-keyword-files" title="Link to this heading">#</a></h2>
<p>This will involve switching between your own and the umadmin account on Azure
Spice and EXAB.</p>
<ul class="simple">
<li><p>As yourself, create a UM Issue to track the test release.</p></li>
<li><p>Ensure you have a <a class="reference internal" href="../../WorkingPractices/forking.html#forking"><span class="std std-ref">fork</span></a> of both the <code class="docutils literal notranslate"><span class="pre">um</span></code> and <code class="docutils literal notranslate"><span class="pre">um_meta</span></code>
repositories, and that the <code class="docutils literal notranslate"><span class="pre">main</span></code> branches in each are up to date with the
upstream repository.</p></li>
<li><p>In a clone of these forks, <a class="reference internal" href="../../WorkingPractices/gh_dev_init.html#create-branch"><span class="std std-ref">create a branch</span></a> using the
<code class="docutils literal notranslate"><span class="pre">main</span></code> branch as the parent. In the UM branch, update the <code class="docutils literal notranslate"><span class="pre">um_meta</span></code> entry
in the <code class="docutils literal notranslate"><span class="pre">dependencies.yaml</span></code> file to point at your metadata branch. Add a link
to both branches from your issue.</p></li>
<li><p>In the UM branch <code class="docutils literal notranslate"><span class="pre">dependencies.yaml</span></code> file, update the <code class="docutils literal notranslate"><span class="pre">um_meta</span></code> entry to
point at your new branch. Update all other entries to point at <code class="docutils literal notranslate"><span class="pre">main</span></code>. This
will use the Heads of each of those repositories for testing.</p></li>
<li><p>As yourself, add the following to <code class="docutils literal notranslate"><span class="pre">~/.metomi/rose.conf</span></code> on Azure Spice and
EXAB. This prevents kgo failures due to the new version number when we test
later.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">rose</span><span class="o">-</span><span class="n">ana</span><span class="p">]</span>
<span class="n">bypass</span><span class="o">-</span><span class="n">version</span><span class="o">-</span><span class="n">check</span><span class="o">=.</span><span class="n">true</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="running-the-release-script">
<h2>Running the Release Script<a class="headerlink" href="#running-the-release-script" title="Link to this heading">#</a></h2>
<p>Move into the rose-stem directory in the UM clone. This is where the release
new version script will be run from. The syntax is,</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>../admin/rose-stem/release_new_version.py<span class="w"> </span>-c<span class="w"> </span>&lt;previous<span class="w"> </span>version&gt;<span class="w"> </span>-n<span class="w"> </span>&lt;new<span class="w"> </span>version&gt;<span class="w"> </span>-j<span class="w"> </span>&lt;new<span class="w"> </span>*JULES*<span class="w"> </span>version&gt;<span class="w"> </span>--test
eg.<span class="w"> </span>../admin/rose-stem/release_new_version.py<span class="w"> </span>-c<span class="w"> </span><span class="m">13</span>.4<span class="w"> </span>-n<span class="w"> </span><span class="m">13</span>.5<span class="w"> </span>-j<span class="w"> </span><span class="m">7</span>.5<span class="w"> </span>--test
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Adding <code class="docutils literal notranslate"><span class="pre">--test</span></code> will prevent the script from updating the Jules version
in the metadata which is needed as the new Jules tag will not yet exist.</p>
</div>
<ul class="simple">
<li><p>Open a new terminal and inspect that the version number update macro added by
the script is correct, and that the tXXXX template macro has been deleted
appropriately.</p>
<ul>
<li><p>This has caused problems before see <cite>this edge case
&lt;https://code.metoffice.gov.uk/trac/um/wiki/ticket/2437/SciTechReview&gt;</cite>.
The upgrade macro should fail to execute if the macro chain is
incorrect, as it won’t be able to upgrade an app to the new version -
this is likely this edge case.</p></li>
</ul>
</li>
<li><p>As there is no kgo installed for the new version revert the changes to
<code class="docutils literal notranslate"><span class="pre">rose-stem/site/meto/variables_*.cylc</span></code> as well as the <code class="docutils literal notranslate"><span class="pre">BASE</span></code> variable at
the bottom of <code class="docutils literal notranslate"><span class="pre">rose-stem/site/meto/variables.cylc</span></code>.</p></li>
</ul>
</section>
<section id="copying-the-metadata-and-upgrade-macros-to-the-um-meta-branch">
<h2>Copying the metadata and upgrade macros to the um_meta branch<a class="headerlink" href="#copying-the-metadata-and-upgrade-macros-to-the-um-meta-branch" title="Link to this heading">#</a></h2>
<p>The next step is to move the macros and metadata into the meta branch. The
metadata will have been created already by the release script. For each of the
<code class="docutils literal notranslate"><span class="pre">um-atmos</span></code>, <code class="docutils literal notranslate"><span class="pre">um-fcm-make</span></code> and <code class="docutils literal notranslate"><span class="pre">um-createbc</span></code> metadata sections, move the
new <code class="docutils literal notranslate"><span class="pre">vnX.Y</span></code> directory into the <code class="docutils literal notranslate"><span class="pre">um_meta</span></code> clone, eg.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>mv<span class="w"> </span>rose-meta/um-atmos/vnX.Y<span class="w"> </span>/path/to/meta_clone/um-atmos/
<span class="nb">cd</span><span class="w"> </span>/path/to/meta_clone
git<span class="w"> </span>add<span class="w"> </span>um-atmos/vnX.Y
</pre></div>
</div>
<p>Note, there is no need to move um-crmstyle as it only contains HEAD metadata.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">um_meta</span></code> clone, manually add a line to each of the
<code class="docutils literal notranslate"><span class="pre">um-atmos/versions.py</span></code>, <code class="docutils literal notranslate"><span class="pre">um-fcm-make/versions.py</span></code> and
<code class="docutils literal notranslate"><span class="pre">um-createbc/versions.py</span></code> files to import the newly copied <code class="docutils literal notranslate"><span class="pre">versionXX_XY.py</span></code>
file (see the existing line).</p>
<p>Commit the changes to both the UM and Meta branches.</p>
</section>
<section id="installing-ctldata-utilities-and-prebuilds">
<h2>Installing Ctldata, Utilities and Prebuilds<a class="headerlink" href="#installing-ctldata-utilities-and-prebuilds" title="Link to this heading">#</a></h2>
<p>These steps are all done as umadmin</p>
<p>Take a copy of the <code class="docutils literal notranslate"><span class="pre">um</span></code> and <code class="docutils literal notranslate"><span class="pre">um_meta</span></code> branches. umadmin can only access the
mirrors so this may be more easily done by copying your own clones.</p>
<p>First check that the upgrade has gone successfully and the new install will
appear in the correct place. Do this by running,</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cylc<span class="w"> </span>vip<span class="w"> </span>-z<span class="w"> </span><span class="nv">g</span><span class="o">=</span>install<span class="w"> </span>-S<span class="w"> </span><span class="nv">CENTRAL_INSTALL</span><span class="o">=</span><span class="nb">false</span><span class="w"> </span>-S<span class="w"> </span><span class="nv">USE_EXAB</span><span class="o">=</span><span class="nb">true</span><span class="w"> </span>-n<span class="w"> </span>umX.Y_test_release<span class="w"> </span>./rose-stem
</pre></div>
</div>
<p>and check that <code class="docutils literal notranslate"><span class="pre">cylc_run/&lt;working_copy_name&gt;/runN/share/vnX.Y</span></code> exists and is
the new version number. If that has worked, change the <code class="docutils literal notranslate"><span class="pre">CENTRALL_INSTALL</span></code> flag
to true and rerun,</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cylc<span class="w"> </span>vip<span class="w"> </span>-z<span class="w"> </span><span class="nv">g</span><span class="o">=</span>install<span class="w"> </span>-S<span class="w"> </span><span class="nv">CENTRAL_INSTALL</span><span class="o">=</span><span class="nb">true</span><span class="w"> </span>-S<span class="w"> </span><span class="nv">USE_EXAB</span><span class="o">=</span><span class="nb">true</span><span class="w"> </span>-n<span class="w"> </span>umX.Y_test_release<span class="w"> </span>./rose-stem
</pre></div>
</div>
<p>Navigate to the input data directory on azure spice
(<code class="docutils literal notranslate"><span class="pre">$UMDIR/standard_jobs/inputs</span></code>) and run the following command which copies
the old directory to the new one, and then creates a new symlink. Replace 11.5
and 11.6 with the correct version numbers,</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>mv<span class="w"> </span>vn11.5<span class="w"> </span>vn11.6<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>vn11.6<span class="w"> </span>vn11.5
</pre></div>
</div>
<p>Repeat this step on <strong>all of</strong> EXAB, EXCD and EXZ.</p>
</section>
<section id="test-the-branch">
<h2>Test the Branch<a class="headerlink" href="#test-the-branch" title="Link to this heading">#</a></h2>
<p>These steps are done as yourself. In your UM branch clone ensure the meta branch
is set in the <code class="docutils literal notranslate"><span class="pre">dependencies.yaml</span></code> file and then run the entire test suite,</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cylc<span class="w"> </span>vip<span class="w"> </span>-z<span class="w"> </span><span class="nv">g</span><span class="o">=</span>all<span class="w"> </span>-S<span class="w"> </span><span class="nv">USE_EXAB</span><span class="o">=</span><span class="nb">true</span><span class="w"> </span>-n<span class="w"> </span>umX.Y_test_release<span class="w"> </span>./rose-stem
</pre></div>
</div>
<p>Before continuing the next step you should make sure the suite has run as
expected. All tests should pass apart from any tasks that output netcdf
(these have _nc in the tasks name) and the SCM tasks. Both of these encode the
UM version and use a direct comparison, it is not as simple to exclude UM
version from the comparison as we did with tests that use mule-cumf.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Check the test results by running something like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">find</span> <span class="o">~</span><span class="n">cylc</span><span class="o">-</span><span class="n">run</span><span class="o">/&lt;</span><span class="n">suite</span> <span class="n">name</span><span class="o">&gt;/</span><span class="n">runN</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">job</span> <span class="o">-</span><span class="n">path</span> <span class="s2">&quot;*rose_ana*&quot;</span> <span class="o">-</span><span class="nb">type</span> <span class="n">f</span> \
    <span class="o">-</span><span class="n">name</span> <span class="n">job</span><span class="o">.</span><span class="n">status</span> \
    <span class="o">|</span> <span class="n">xargs</span> <span class="n">grep</span> <span class="o">-</span><span class="n">l</span> <span class="n">CYLC_JOB_EXIT</span><span class="o">=</span><span class="n">ERR</span> \
    <span class="o">|</span> <span class="n">grep</span> <span class="o">-</span><span class="n">vE</span> <span class="s2">&quot;(scm|netcdf)</span>
</pre></div>
</div>
</div>
</section>
<section id="test-on-monsoon">
<h2>Test on Monsoon<a class="headerlink" href="#test-on-monsoon" title="Link to this heading">#</a></h2>
<p>It’s also sensible to check now that nothing has broken on Monsoon. Do this by
cloning the UM main and meta branches and run the test suite as you did in the
previous section except for the group which should now be <code class="docutils literal notranslate"><span class="pre">ex1a</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At the time of writing, the solution for extracting from GitHub on monsoon
is unknown</p>
</div>
</section>
<section id="reset-keywords-and-remove-prebuilds-important">
<h2>Reset Keywords and Remove Prebuilds (Important!)<a class="headerlink" href="#reset-keywords-and-remove-prebuilds-important" title="Link to this heading">#</a></h2>
<p>As both yourself and umadmin,</p>
<ul class="simple">
<li><p>Remove or comment out the <code class="docutils literal notranslate"><span class="pre">bypass-version-check</span></code> in
<code class="docutils literal notranslate"><span class="pre">~/.metomi/rose.conf</span></code></p>
<ul>
<li><p>Make sure to do this on <strong>all</strong> platforms (inlcuding Monsoon)</p></li>
<li><p>Not doing so can result in some weird behaviour down the line</p></li>
</ul>
</li>
<li><p>As umadmin, remove the installed release, by deleting the <code class="docutils literal notranslate"><span class="pre">$UMDIR/vnX.Y</span></code>
directory</p></li>
</ul>
<p>The test release is now done!</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../curaterelease.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Curating a Release</p>
      </div>
    </a>
    <a class="right-next"
       href="partner_testing.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Partner Testing</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparing-test-release-branches-and-keyword-files">Preparing Test Release Branches and Keyword Files</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-release-script">Running the Release Script</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#copying-the-metadata-and-upgrade-macros-to-the-um-meta-branch">Copying the metadata and upgrade macros to the um_meta branch</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installing-ctldata-utilities-and-prebuilds">Installing Ctldata, Utilities and Prebuilds</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#test-the-branch">Test the Branch</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#test-on-monsoon">Test on Monsoon</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reset-keywords-and-remove-prebuilds-important">Reset Keywords and Remove Prebuilds (Important!)</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

<p class="copyright">
    
    © Crown Copyright, Met Office
    <br/>
    
</p>
</div>
      
    </div>
  
  
    <div class="footer-items__center">
      
        <div class="footer-item">
<div class="tocsection accessibilitylink">
        <a href="../../accessibility.html">Accessibility</a>
</div></div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>